{"version":3,"sources":["webpack://CyanoMobile/webpack/bootstrap","webpack://CyanoMobile/./src/CyanoBridge.ts","webpack://CyanoMobile/./src/client/asset.ts","webpack://CyanoMobile/./src/client/identity.ts","webpack://CyanoMobile/./src/client/index.ts","webpack://CyanoMobile/./src/client/message.ts","webpack://CyanoMobile/./src/client/proxy.ts","webpack://CyanoMobile/./src/client/smartcontract.ts","webpack://CyanoMobile/./src/index.ts","webpack://CyanoMobile/./src/utils.ts"],"names":[],"mappings":"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","file":"browser.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","\nimport { makeInvokeFunction } from './utils';\n\nclass CyanoBridge {\n\n    version: string;\n    listener: (e: any) => any;\n    timeout: number = 3000;\n    constructor(timeout?: number) {\n        this.version = 'v1.0.0';\n        if (timeout) {\n            this.timeout = timeout;\n        }\n    }\n\n    // tslint:disable:jsdoc-format\n\n    /**\n     * Return the uri to get account from provider\n     * @params {object} params\n     * {\n         \"dappName\": string, // dApp name\n         \"dappIcon\": string // url that points to the icon of the dapp\n        }\n     */\n\n    getAccount(params?: {dappName: string, dappIcon: string}) {\n        return new Promise((resolve, reject) => {\n            const req = {\n                action: 'getAccount',\n                version: this.version,\n                params\n            };\n            const msg = btoa(encodeURIComponent(JSON.stringify(req)));\n            const uri = 'ontprovider://ont.io?params=' + msg;\n            this.sendMessage(uri);\n            this.handleMessageEvent(resolve, reject, 'getAccount', true);\n        });\n    }\n    /**\n     * Return the uri to get identity from provider\n     * @params {object} params\n     * {\n         \"dappName\": string, // dApp name\n         \"dappIcon\": string // url that points to the icon of the dapp\n        }\n     */\n    getIdentity(params?: { dappName: string, dappIcon: string}) {\n        return new Promise((resolve, reject) => {\n            const req = {\n                action: 'getIdentity',\n                version: this.version,\n                params\n            };\n            const msg = btoa(encodeURIComponent(JSON.stringify(req)));\n            const uri = 'ontprovider://ont.io?params=' + msg;\n            this.sendMessage(uri);\n            this.handleMessageEvent(resolve, reject, 'getIdentity', true);\n        });\n    }\n\n    /**\n     * We define the login process is: dapp will send a message to native client,\n     * native client will sign the message with\n     * user's private key and send back,dapp will verify the signature to decide if login or not.\n     * @params params\n     * params: {\n         type: 'account',// account or identity that will sign the message\n         dappName: 'My dapp', // dapp's name\n         dappIcon: 'http://mydapp.com/icon.png', // some url that points to the dapp's icon\n         message: 'test message', // message sent from dapp that will be signed by native client\n         expired: new Date('2019-01-01').getTime(), // expired date of login\n         callback: '' // callback url of dapp\n     }\n     */\n    login(params: {\n        message: string,\n        type: string,\n        dappName: string,\n        dappIcon: string,\n        expired: number,\n        callback: string\n    }) {\n        if (!params.message || typeof params.message !== 'string') {\n            throw new Error('Parameter for login must contain a message.');\n        }\n        if (!params.type) {\n            params.type = 'account';\n        }\n\n        return new Promise((resolve, reject) => {\n            const req = {\n                action: 'login',\n                version: this.version,\n                params\n            };\n            const msg = btoa(encodeURIComponent(JSON.stringify(req)));\n            const uri = 'ontprovider://ont.io?params=' + msg;\n            this.sendMessage(uri);\n            this.handleMessageEvent(resolve, reject, 'login', false);\n        });\n    }\n\n    /**\n     * Invoke smart contract that needs wallet signature.\n     * @param {string} scriptHash Scripthash of smart contract\n     * @param {string} operation  Method to invoke\n     * @param {[Parameter]} args\n     * @param {number} gasPrice\n     * @param {number} gasLimit\n     * @param {JSON object} config optional configs\n     * config: {\n     *  login: bool // logined or not\n     *  message: string // message to show in native client,\n     *  url: string // callback url to get signed transaction\n     * }\n     */\n    invoke(scriptHash: string,\n           operation: string,\n           args: any[],\n           gasPrice = 500,\n           gasLimit = 200000,\n           payer: string,\n           config = {\n               login: true,\n               message: '',\n               url: ''\n           }) {\n        if (!scriptHash || !operation || !args || args.length === 0) {\n            throw new Error('Invalid params.');\n        }\n        if (!payer) {\n            throw new Error('No payer.');\n        }\n\n        return new Promise((resolve, reject) => {\n            const functionParams = makeInvokeFunction(operation, args);\n            const req = {\n                action: 'invoke',\n                version: this.version,\n                params: {\n                    login: config.login,\n                    url: config.url,\n                    message: config.message,\n                    invokeConfig: {\n                        contractHash: scriptHash,\n                        functions: [functionParams],\n                        payer,\n                        gasLimit,\n                        gasPrice\n                    }\n                }\n            };\n            const msg = btoa(encodeURIComponent(JSON.stringify(req)));\n            const uri = 'ontprovider://ont.io?params=' + msg;\n            this.sendMessage(uri);\n            this.handleMessageEvent(resolve, reject, 'invoke', false);\n        });\n    }\n\n    call(req: any) {\n        return new Promise((resolve, reject) => {\n            const msg = btoa(encodeURIComponent(JSON.stringify(req)));\n            const uri = 'ontprovider://ont.io?params=' + msg;\n            this.sendMessage(uri);\n            this.handleMessageEvent(resolve, reject, req.action, req.needTimeout);\n        });\n    }\n\n    invokeRead() {\n        throw new Error('invokeRead not supported yet.');\n    }\n\n    parseMessage(msg: string): any {\n        return JSON.parse(decodeURIComponent(atob(msg)));\n    }\n\n    onMessage(handler: (res: any) => {}) {\n        if (this.listener) {\n            this.offMessage();\n        }\n        const listener = (e: any) => {\n            const res = this.parseMessage(e.data);\n            handler(res);\n        };\n        window.document.addEventListener('message', listener);\n        this.listener = listener;\n    }\n\n    offMessage() {\n        window.document.removeEventListener('message', this.listener);\n    }\n\n    private sendMessage(msg: string) {\n        window.postMessage(msg, '*');\n    }\n\n    private handleMessageEvent(resolve: any, reject: any, action: string, needTimeout: boolean = false) {\n        const handler = (event: any) => {\n            const message = event.data;\n            if (!message) {\n                reject(message);\n            }\n            document.removeEventListener('message', handler);\n            const res = this.parseMessage(message);\n            if (res.action === action) {\n                resolve(res);\n            } else {\n                reject(res);\n            }\n        };\n        document.addEventListener('message', handler);\n        if (needTimeout) {\n            setTimeout(() => {\n                reject('Time out');\n            }, this.timeout);\n        }\n    }\n\n}\n\nexport default CyanoBridge;\n","import { call, version } from './proxy';\n\nexport const assetApi = {\n    getAccount(params?: { dappName: string, dappIcon: string }) {\n        const req = {\n            action: 'getAccount',\n            version,\n            params,\n            needTimeout: true\n        };\n        return call(req);\n    }\n};\n","import { call, version } from './proxy';\n\nexport const identityApi = {\n    getIdentity(params?: { dappName: string, dappIcon: string }) {\n        const req = {\n            action: 'getIdentity',\n            version,\n            params,\n            needTimeout: true\n        };\n        return call(req);\n    }\n};\n","import { assetApi as asset } from './asset';\nimport { identityApi as identity } from './identity';\nimport { messageApi as message } from './message';\nimport { scApi as smartContract } from './smartcontract';\n\nimport { registerClient } from './proxy';\n\nconst api = {\n    asset,\n    identity,\n    message,\n    smartContract\n};\n\nexport { registerClient, api};\n","import { call, version } from './proxy';\n\nexport const messageApi = {\n    signMessage(params: {message: string}) {\n        const req = {\n            action: 'login',\n            version,\n            params,\n            needTimeout: false\n        };\n        return call(req);\n    },\n\n    login(params: {\n        message: string,\n        type: string,\n        dappName: string,\n        dappIcon: string,\n        expired: number,\n        callback: string\n    }) {\n        if (!params.message || typeof params.message !== 'string') {\n            throw new Error('Parameter for login must contain a message.');\n        }\n        if (!params.type) {\n            params.type = 'account';\n        }\n        const req = {\n            action: 'login',\n            version,\n            params,\n            needTimeout: false\n        };\n        return call(req);\n    }\n};\n","import CyanoBridge from '../CyanoBridge';\n\nlet cb: CyanoBridge;\n\nexport function registerClient(timeout: number = 3000) {\n    cb = new CyanoBridge(timeout);\n}\n\nexport async function call(request: any) {\n    return cb.call(request);\n}\n\nexport const version = '1.0.0';\n","import { makeInvokeFunction } from '../utils';\nimport { call, version } from './proxy';\n\n// tslint:disable-next-line:one-variable-per-declaration\nexport const scApi = {\n    invoke(params: {\n        scriptHash: string,\n        operation: string,\n        args: any[],\n        gasPrice: number,\n        gasLimit: number,\n        payer: string,\n        config: {\n            login: boolean,\n            message: string,\n            url: string\n        }\n    }) {\n        if (!params.scriptHash || !params.operation || !params.args || params.args.length === 0) {\n            throw new Error('Invalid params.');\n        }\n        if (!params.payer) {\n            throw new Error('No payer.');\n        }\n\n        if (!params.config) {\n            params.config = {\n                login: true,\n                message: '',\n                url: ''\n            };\n        }\n        const functionParams = makeInvokeFunction(params.operation, params.args);\n        const req: any = {\n            action: 'invoke',\n            version,\n            params: {\n                login: params.config.login,\n                url: params.config.url,\n                message: params.config.message,\n                invokeConfig: {\n                    contractHash: params.scriptHash,\n                    functions: [functionParams],\n                    payer: params.payer,\n                    gasPrice: params.gasLimit = 500,\n                    gasLimit: params.gasPrice = 200000\n                }\n            }\n        };\n        return call(req);\n    },\n    invokeRead(params: {\n        scriptHash: string,\n        operation: string,\n        args: any[],\n        gasPrice: number,\n        gasLimit: number,\n        payer?: string,\n        config: {\n            login: boolean,\n            message: string,\n            url: string\n        }\n    }) {\n        if (!params.scriptHash || !params.operation || !params.args || params.args.length === 0) {\n            throw new Error('Invalid params.');\n        }\n\n        if (!params.config) {\n            params.config = {\n                login: true,\n                message: '',\n                url: ''\n            };\n        }\n        const functionParams = makeInvokeFunction(params.operation, params.args);\n        const req: any = {\n            action: 'invokeRead',\n            version,\n            params: {\n                login: params.config.login,\n                url: params.config.url,\n                message: params.config.message,\n                invokeConfig: {\n                    contractHash: params.scriptHash,\n                    functions: [functionParams],\n                    payer: params.payer,\n                    gasPrice: params.gasLimit = 500,\n                    gasLimit: params.gasPrice = 200000\n                }\n            }\n        };\n        return call(req);\n    }\n};\n","// import CyanoBridge from './CyanoBridge';\nimport * as client from './client';\n\n// export { CyanoBridge };\n\nexport { client };\n","export function formatArgItem(p: any) {\n    if (p.type === 'Boolean' || p.type === 'Integer') {\n        return {\n            name: p.name,\n            value: p.value\n        };\n    } else if (p.type === 'String' || p.type === 'ByteArray' || p.type === 'Long' || p.type === 'Address') {\n        return {\n            name: p.name,\n            value: p.type + ':' + p.value\n        };\n    } else if (p.type === 'Array') {\n        return {\n            name: p.name,\n            value: p.value.map((v: any) => formatArgItem(v))\n        };\n    } else if (p.type === 'Map') {\n        const val: any = {};\n        for (const k of Object.keys(p.value)) {\n            val[k] = formatArgItem(p.value[k]);\n        }\n        return {\n            name: p.name,\n            value: val\n        };\n    } else {\n        throw new Error('Invalid parmeter type: ' + JSON.stringify(p));\n    }\n}\n\nexport function makeInvokeFunction(operation: string, args: any[]) {\n    const params = [];\n    for (const p of args) {\n        params.push(formatArgItem(p));\n    }\n    const obj = {\n        operation,\n        args: params\n    };\n    return obj;\n}\n"],"sourceRoot":""}